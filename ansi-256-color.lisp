(defpackage :swterm.ansi-256-color
  (:use :cl)
  (:export
   :*colors*
   :color-from-name))

(in-package :swterm.ansi-256-color)

(defparameter *colors*
  #(#x000000 #xCD3131 #x0DBC79 #xE5E510 #x2472C8 #xBC3FBC #x11A8CD #xE5E5E5
    #x666666 #xF14C4C #x23D18B #xF5F543 #x3B8EEA #x3B8EEA #x29B8DB #xE5E5E5
    #x000000 #x00005f #x000087 #x0000af #x0000d7 #x0000ff #x005f00 #x005f5f
    #x005f87 #x005faf #x005fd7 #x005fff #x008700 #x00875f #x008787 #x0087af
    #x0087d7 #x0087ff #x00af00 #x00af5f #x00af87 #x00afaf #x00afd7 #x00afff
    #x00d700 #x00d75f #x00d787 #x00d7af #x00d7d7 #x00d7ff #x00ff00 #x00ff5f
    #x00ff87 #x00ffaf #x00ffd7 #x00ffff #x5f0000 #x5f005f #x5f0087 #x5f00af
    #x5f00d7 #x5f00ff #x5f5f00 #x5f5f5f #x5f5f87 #x5f5faf #x5f5fd7 #x5f5fff
    #x5f8700 #x5f875f #x5f8787 #x5f87af #x5f87d7 #x5f87ff #x5faf00 #x5faf5f
    #x5faf87 #x5fafaf #x5fafd7 #x5fafff #x5fd700 #x5fd75f #x5fd787 #x5fd7af
    #x5fd7d7 #x5fd7ff #x5fff00 #x5fff5f #x5fff87 #x5fffaf #x5fffd7 #x5fffff
    #x870000 #x87005f #x870087 #x8700af #x8700d7 #x8700ff #x875f00 #x875f5f
    #x875f87 #x875faf #x875fd7 #x875fff #x878700 #x87875f #x878787 #x8787af
    #x8787d7 #x8787ff #x87af00 #x87af5f #x87af87 #x87afaf #x87afd7 #x87afff
    #x87d700 #x87d75f #x87d787 #x87d7af #x87d7d7 #x87d7ff #x87ff00 #x87ff5f
    #x87ff87 #x87ffaf #x87ffd7 #x87ffff #xaf0000 #xaf005f #xaf0087 #xaf00af
    #xaf00d7 #xaf00ff #xaf5f00 #xaf5f5f #xaf5f87 #xaf5faf #xaf5fd7 #xaf5fff
    #xaf8700 #xaf875f #xaf8787 #xaf87af #xaf87d7 #xaf87ff #xafaf00 #xafaf5f
    #xafaf87 #xafafaf #xafafd7 #xafafff #xafd700 #xafd75f #xafd787 #xafd7af
    #xafd7d7 #xafd7ff #xafff00 #xafff5f #xafff87 #xafffaf #xafffd7 #xafffff
    #xd70000 #xd7005f #xd70087 #xd700af #xd700d7 #xd700ff #xd75f00 #xd75f5f
    #xd75f87 #xd75faf #xd75fd7 #xd75fff #xd78700 #xd7875f #xd78787 #xd787af
    #xd787d7 #xd787ff #xd7af00 #xd7af5f #xd7af87 #xd7afaf #xd7afd7 #xd7afff
    #xd7d700 #xd7d75f #xd7d787 #xd7d7af #xd7d7d7 #xd7d7ff #xd7ff00 #xd7ff5f
    #xd7ff87 #xd7ffaf #xd7ffd7 #xd7ffff #xff0000 #xff005f #xff0087 #xff00af
    #xff00d7 #xff00ff #xff5f00 #xff5f5f #xff5f87 #xff5faf #xff5fd7 #xff5fff
    #xff8700 #xff875f #xff8787 #xff87af #xff87d7 #xff87ff #xffaf00 #xffaf5f
    #xffaf87 #xffafaf #xffafd7 #xffafff #xffd700 #xffd75f #xffd787 #xffd7af
    #xffd7d7 #xffd7ff #xffff00 #xffff5f #xffff87 #xffffaf #xffffd7 #xffffff
    #x080808 #x121212 #x1c1c1c #x262626 #x303030 #x3a3a3a #x444444 #x4e4e4e
    #x585858 #x626262 #x6c6c6c #x767676 #x808080 #x8a8a8a #x949494 #x9e9e9e
    #xa8a8a8 #xb2b2b2 #xbcbcbc #xc6c6c6 #xd0d0d0 #xdadada #xe4e4e4 #xeeeeee))

(defparameter *name-index-table* (make-hash-table :size 256))
(setf (gethash :black *name-index-table*) 0)
(setf (gethash :maroon *name-index-table*) 1)
(setf (gethash :green *name-index-table*) 2)
(setf (gethash :olive *name-index-table*) 3)
(setf (gethash :navy *name-index-table*) 4)
(setf (gethash :purple *name-index-table*) 5)
(setf (gethash :teal *name-index-table*) 6)
(setf (gethash :silver *name-index-table*) 7)
(setf (gethash :grey *name-index-table*) 8)
(setf (gethash :red *name-index-table*) 9)
(setf (gethash :lime *name-index-table*) 10)
(setf (gethash :yellow *name-index-table*) 11)
(setf (gethash :blue *name-index-table*) 12)
(setf (gethash :fuchsia *name-index-table*) 13)
(setf (gethash :aqua *name-index-table*) 14)
(setf (gethash :white *name-index-table*) 15)
(setf (gethash :grey0 *name-index-table*) 16)
(setf (gethash :navy-blue *name-index-table*) 17)
(setf (gethash :dark-blue *name-index-table*) 18)
(setf (gethash :blue3 *name-index-table*) 19)
(setf (gethash :blue3 *name-index-table*) 20)
(setf (gethash :blue1 *name-index-table*) 21)
(setf (gethash :dark-green *name-index-table*) 22)
(setf (gethash :deep-sky-blue4 *name-index-table*) 23)
(setf (gethash :deep-sky-blue4 *name-index-table*) 24)
(setf (gethash :deep-sky-blue4 *name-index-table*) 25)
(setf (gethash :dodger-blue3 *name-index-table*) 26)
(setf (gethash :dodger-blue2 *name-index-table*) 27)
(setf (gethash :green4 *name-index-table*) 28)
(setf (gethash :spring-green4 *name-index-table*) 29)
(setf (gethash :turquoise4 *name-index-table*) 30)
(setf (gethash :deep-sky-blue3 *name-index-table*) 31)
(setf (gethash :deep-sky-blue3 *name-index-table*) 32)
(setf (gethash :dodger-blue1 *name-index-table*) 33)
(setf (gethash :green3 *name-index-table*) 34)
(setf (gethash :spring-green3 *name-index-table*) 35)
(setf (gethash :dark-cyan *name-index-table*) 36)
(setf (gethash :light-sea-green *name-index-table*) 37)
(setf (gethash :deep-sky-blue2 *name-index-table*) 38)
(setf (gethash :deep-sky-blue1 *name-index-table*) 39)
(setf (gethash :green3 *name-index-table*) 40)
(setf (gethash :spring-green3 *name-index-table*) 41)
(setf (gethash :spring-green2 *name-index-table*) 42)
(setf (gethash :cyan3 *name-index-table*) 43)
(setf (gethash :dark-turquoise *name-index-table*) 44)
(setf (gethash :turquoise2 *name-index-table*) 45)
(setf (gethash :green1 *name-index-table*) 46)
(setf (gethash :spring-green2 *name-index-table*) 47)
(setf (gethash :spring-green1 *name-index-table*) 48)
(setf (gethash :medium-spring-green *name-index-table*) 49)
(setf (gethash :cyan2 *name-index-table*) 50)
(setf (gethash :cyan1 *name-index-table*) 51)
(setf (gethash :dark-red *name-index-table*) 52)
(setf (gethash :deep-pink4 *name-index-table*) 53)
(setf (gethash :purple4 *name-index-table*) 54)
(setf (gethash :purple4 *name-index-table*) 55)
(setf (gethash :purple3 *name-index-table*) 56)
(setf (gethash :blue-violet *name-index-table*) 57)
(setf (gethash :orange4 *name-index-table*) 58)
(setf (gethash :grey37 *name-index-table*) 59)
(setf (gethash :medium-purple4 *name-index-table*) 60)
(setf (gethash :slate-blue3 *name-index-table*) 61)
(setf (gethash :slate-blue3 *name-index-table*) 62)
(setf (gethash :royal-blue1 *name-index-table*) 63)
(setf (gethash :chartreuse4 *name-index-table*) 64)
(setf (gethash :dark-sea-green4 *name-index-table*) 65)
(setf (gethash :pale-turquoise4 *name-index-table*) 66)
(setf (gethash :steel-blue *name-index-table*) 67)
(setf (gethash :steel-blue3 *name-index-table*) 68)
(setf (gethash :cornflower-blue *name-index-table*) 69)
(setf (gethash :chartreuse3 *name-index-table*) 70)
(setf (gethash :dark-sea-green4 *name-index-table*) 71)
(setf (gethash :cadet-blue *name-index-table*) 72)
(setf (gethash :cadet-blue *name-index-table*) 73)
(setf (gethash :sky-blue3 *name-index-table*) 74)
(setf (gethash :steel-blue1 *name-index-table*) 75)
(setf (gethash :chartreuse3 *name-index-table*) 76)
(setf (gethash :pale-green3 *name-index-table*) 77)
(setf (gethash :sea-green3 *name-index-table*) 78)
(setf (gethash :aquamarine3 *name-index-table*) 79)
(setf (gethash :medium-turquoise *name-index-table*) 80)
(setf (gethash :steel-blue1 *name-index-table*) 81)
(setf (gethash :chartreuse2 *name-index-table*) 82)
(setf (gethash :sea-green2 *name-index-table*) 83)
(setf (gethash :sea-green1 *name-index-table*) 84)
(setf (gethash :sea-green1 *name-index-table*) 85)
(setf (gethash :aquamarine1 *name-index-table*) 86)
(setf (gethash :dark-slate-gray2 *name-index-table*) 87)
(setf (gethash :dark-red *name-index-table*) 88)
(setf (gethash :deep-pink4 *name-index-table*) 89)
(setf (gethash :dark-magenta *name-index-table*) 90)
(setf (gethash :dark-magenta *name-index-table*) 91)
(setf (gethash :dark-violet *name-index-table*) 92)
(setf (gethash :purple *name-index-table*) 93)
(setf (gethash :orange4 *name-index-table*) 94)
(setf (gethash :light-pink4 *name-index-table*) 95)
(setf (gethash :plum4 *name-index-table*) 96)
(setf (gethash :medium-purple3 *name-index-table*) 97)
(setf (gethash :medium-purple3 *name-index-table*) 98)
(setf (gethash :slate-blue1 *name-index-table*) 99)
(setf (gethash :yellow4 *name-index-table*) 100)
(setf (gethash :wheat4 *name-index-table*) 101)
(setf (gethash :grey53 *name-index-table*) 102)
(setf (gethash :light-slate-grey *name-index-table*) 103)
(setf (gethash :medium-purple *name-index-table*) 104)
(setf (gethash :light-slate-blue *name-index-table*) 105)
(setf (gethash :yellow4 *name-index-table*) 106)
(setf (gethash :dark-olive-green3 *name-index-table*) 107)
(setf (gethash :dark-sea-green *name-index-table*) 108)
(setf (gethash :light-sky-blue3 *name-index-table*) 109)
(setf (gethash :light-sky-blue3 *name-index-table*) 110)
(setf (gethash :sky-blue2 *name-index-table*) 111)
(setf (gethash :chartreuse2 *name-index-table*) 112)
(setf (gethash :dark-olive-green3 *name-index-table*) 113)
(setf (gethash :pale-green3 *name-index-table*) 114)
(setf (gethash :dark-sea-green3 *name-index-table*) 115)
(setf (gethash :dark-slate-gray3 *name-index-table*) 116)
(setf (gethash :sky-blue1 *name-index-table*) 117)
(setf (gethash :chartreuse1 *name-index-table*) 118)
(setf (gethash :light-green *name-index-table*) 119)
(setf (gethash :light-green *name-index-table*) 120)
(setf (gethash :pale-green1 *name-index-table*) 121)
(setf (gethash :aquamarine1 *name-index-table*) 122)
(setf (gethash :dark-slate-gray1 *name-index-table*) 123)
(setf (gethash :red3 *name-index-table*) 124)
(setf (gethash :deep-pink4 *name-index-table*) 125)
(setf (gethash :medium-violet-red *name-index-table*) 126)
(setf (gethash :magenta3 *name-index-table*) 127)
(setf (gethash :dark-violet *name-index-table*) 128)
(setf (gethash :purple *name-index-table*) 129)
(setf (gethash :dark-orange3 *name-index-table*) 130)
(setf (gethash :indian-red *name-index-table*) 131)
(setf (gethash :hot-pink3 *name-index-table*) 132)
(setf (gethash :medium-orchid3 *name-index-table*) 133)
(setf (gethash :medium-orchid *name-index-table*) 134)
(setf (gethash :medium-purple2 *name-index-table*) 135)
(setf (gethash :dark-goldenrod *name-index-table*) 136)
(setf (gethash :light-salmon3 *name-index-table*) 137)
(setf (gethash :rosy-brown *name-index-table*) 138)
(setf (gethash :grey63 *name-index-table*) 139)
(setf (gethash :medium-purple2 *name-index-table*) 140)
(setf (gethash :medium-purple1 *name-index-table*) 141)
(setf (gethash :gold3 *name-index-table*) 142)
(setf (gethash :dark-khaki *name-index-table*) 143)
(setf (gethash :navajo-white3 *name-index-table*) 144)
(setf (gethash :grey69 *name-index-table*) 145)
(setf (gethash :light-steel-blue3 *name-index-table*) 146)
(setf (gethash :light-steel-blue *name-index-table*) 147)
(setf (gethash :yellow3 *name-index-table*) 148)
(setf (gethash :dark-olive-green3 *name-index-table*) 149)
(setf (gethash :dark-sea-green3 *name-index-table*) 150)
(setf (gethash :dark-sea-green2 *name-index-table*) 151)
(setf (gethash :light-cyan3 *name-index-table*) 152)
(setf (gethash :light-sky-blue1 *name-index-table*) 153)
(setf (gethash :green-yellow *name-index-table*) 154)
(setf (gethash :dark-olive-green2 *name-index-table*) 155)
(setf (gethash :pale-green1 *name-index-table*) 156)
(setf (gethash :dark-sea-green2 *name-index-table*) 157)
(setf (gethash :dark-sea-green1 *name-index-table*) 158)
(setf (gethash :pale-turquoise1 *name-index-table*) 159)
(setf (gethash :red3 *name-index-table*) 160)
(setf (gethash :deep-pink3 *name-index-table*) 161)
(setf (gethash :deep-pink3 *name-index-table*) 162)
(setf (gethash :magenta3 *name-index-table*) 163)
(setf (gethash :magenta3 *name-index-table*) 164)
(setf (gethash :magenta2 *name-index-table*) 165)
(setf (gethash :dark-orange3 *name-index-table*) 166)
(setf (gethash :indian-red *name-index-table*) 167)
(setf (gethash :hot-pink3 *name-index-table*) 168)
(setf (gethash :hot-pink2 *name-index-table*) 169)
(setf (gethash :orchid *name-index-table*) 170)
(setf (gethash :medium-orchid1 *name-index-table*) 171)
(setf (gethash :orange3 *name-index-table*) 172)
(setf (gethash :light-salmon3 *name-index-table*) 173)
(setf (gethash :light-pink3 *name-index-table*) 174)
(setf (gethash :pink3 *name-index-table*) 175)
(setf (gethash :plum3 *name-index-table*) 176)
(setf (gethash :violet *name-index-table*) 177)
(setf (gethash :gold3 *name-index-table*) 178)
(setf (gethash :light-goldenrod3 *name-index-table*) 179)
(setf (gethash :tan *name-index-table*) 180)
(setf (gethash :misty-rose3 *name-index-table*) 181)
(setf (gethash :thistle3 *name-index-table*) 182)
(setf (gethash :plum2 *name-index-table*) 183)
(setf (gethash :yellow3 *name-index-table*) 184)
(setf (gethash :khaki3 *name-index-table*) 185)
(setf (gethash :light-goldenrod2 *name-index-table*) 186)
(setf (gethash :light-yellow3 *name-index-table*) 187)
(setf (gethash :grey84 *name-index-table*) 188)
(setf (gethash :light-steel-blue1 *name-index-table*) 189)
(setf (gethash :yellow2 *name-index-table*) 190)
(setf (gethash :dark-olive-green1 *name-index-table*) 191)
(setf (gethash :dark-olive-green1 *name-index-table*) 192)
(setf (gethash :dark-sea-green1 *name-index-table*) 193)
(setf (gethash :honeydew2 *name-index-table*) 194)
(setf (gethash :light-cyan1 *name-index-table*) 195)
(setf (gethash :red1 *name-index-table*) 196)
(setf (gethash :deep-pink2 *name-index-table*) 197)
(setf (gethash :deep-pink1 *name-index-table*) 198)
(setf (gethash :deep-pink1 *name-index-table*) 199)
(setf (gethash :magenta2 *name-index-table*) 200)
(setf (gethash :magenta1 *name-index-table*) 201)
(setf (gethash :orange-red1 *name-index-table*) 202)
(setf (gethash :indian-red1 *name-index-table*) 203)
(setf (gethash :indian-red1 *name-index-table*) 204)
(setf (gethash :hot-pink *name-index-table*) 205)
(setf (gethash :hot-pink *name-index-table*) 206)
(setf (gethash :medium-orchid1 *name-index-table*) 207)
(setf (gethash :dark-orange *name-index-table*) 208)
(setf (gethash :salmon1 *name-index-table*) 209)
(setf (gethash :light-coral *name-index-table*) 210)
(setf (gethash :pale-violet-red1 *name-index-table*) 211)
(setf (gethash :orchid2 *name-index-table*) 212)
(setf (gethash :orchid1 *name-index-table*) 213)
(setf (gethash :orange1 *name-index-table*) 214)
(setf (gethash :sandy-brown *name-index-table*) 215)
(setf (gethash :light-salmon1 *name-index-table*) 216)
(setf (gethash :light-pink1 *name-index-table*) 217)
(setf (gethash :pink1 *name-index-table*) 218)
(setf (gethash :plum1 *name-index-table*) 219)
(setf (gethash :gold1 *name-index-table*) 220)
(setf (gethash :light-goldenrod2 *name-index-table*) 221)
(setf (gethash :light-goldenrod2 *name-index-table*) 222)
(setf (gethash :navajo-white1 *name-index-table*) 223)
(setf (gethash :misty-rose1 *name-index-table*) 224)
(setf (gethash :thistle1 *name-index-table*) 225)
(setf (gethash :yellow1 *name-index-table*) 226)
(setf (gethash :light-goldenrod1 *name-index-table*) 227)
(setf (gethash :khaki1 *name-index-table*) 228)
(setf (gethash :wheat1 *name-index-table*) 229)
(setf (gethash :cornsilk1 *name-index-table*) 230)
(setf (gethash :grey100 *name-index-table*) 231)
(setf (gethash :grey3 *name-index-table*) 232)
(setf (gethash :grey7 *name-index-table*) 233)
(setf (gethash :grey11 *name-index-table*) 234)
(setf (gethash :grey15 *name-index-table*) 235)
(setf (gethash :grey19 *name-index-table*) 236)
(setf (gethash :grey23 *name-index-table*) 237)
(setf (gethash :grey27 *name-index-table*) 238)
(setf (gethash :grey30 *name-index-table*) 239)
(setf (gethash :grey35 *name-index-table*) 240)
(setf (gethash :grey39 *name-index-table*) 241)
(setf (gethash :grey42 *name-index-table*) 242)
(setf (gethash :grey46 *name-index-table*) 243)
(setf (gethash :grey50 *name-index-table*) 244)
(setf (gethash :grey54 *name-index-table*) 245)
(setf (gethash :grey58 *name-index-table*) 246)
(setf (gethash :grey62 *name-index-table*) 247)
(setf (gethash :grey66 *name-index-table*) 248)
(setf (gethash :grey70 *name-index-table*) 249)
(setf (gethash :grey74 *name-index-table*) 250)
(setf (gethash :grey78 *name-index-table*) 251)
(setf (gethash :grey82 *name-index-table*) 252)
(setf (gethash :grey85 *name-index-table*) 253)
(setf (gethash :grey89 *name-index-table*) 254)
(setf (gethash :grey93 *name-index-table*) 255)

(defun color-from-name (name)
  (elt *colors* (gethash name *name-index-table*)))
